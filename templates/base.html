{% load static %}

<!DOCTYPE html>
<html>

<head>
    <!-- meta tags  -->
    {% block meta %}
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    {% endblock %}
    <!-- end meta tags  -->

    {% block extra_meta %}

    {% endblock %}

    {% block corecss %}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lobster&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/base.css' %}">
    {% endblock %}

    {% block extra_css %}
    {% endblock %}

    {% block corejs %}
    <script src="https://kit.fontawesome.com/3f6b0a0556.js" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://js.stripe.com/v3/"></script>
    {% endblock %}

    {% block extra_js %}
    {% endblock %}

    <title>Knit Happens {% block extra_title %} {% endblock %}</title>
</head>

<body>
    <section class="hero is-large">
        <!-- navigation  -->
        <div class="hero-head">
            <nav class="navbar has-shadow" role="navigation" aria-label="main navigation">
                <div class="navbar-brand">
                    <a class="navbar-item" href="{% url 'home' %}">
                        <!-- <img src="media/knitting-black.png" alt="home-button" class="home-button"> -->
                        <h1 class="title-heading">Knit Happens</h1>
                    </a>
                    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false"
                        data-target="navbarBasicExample">
                        <span aria-hidden="true"></span>
                        <span aria-hidden="true"></span>
                        <span aria-hidden="true"></span>
                    </a>
                </div>

                <div id="navbarBasicExample" class="navbar-menu">
                    <div class="navbar-start ">
                        <!-- search form  -->
                        <div class="column is-vcentered is-hidden-touch">
                            <div class="field has-addons search-form">
                                <div class="control" method="GET" action="">
                                    <input class="input" type="text" placeholder="Find a product" name="q">
                                </div>
                                <div class="control">
                                    <a class="button is-danger">
                                        <i class="fas fa-search"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                        <!-- end of search form  -->
                    </div>
                    <!-- right side of navbar hidden mobile  -->
                    <div class="navbar-end is-hidden-touch">
                        <a class="navbar-item" href="#">
                            <img src="../media/blog.png" alt="blog">
                        </a>
                        {% if request.user.is_authenticated %}
                        {% if request.user.is_superuser %}
                        <a class="navbar-item" href="">
                            <img src="../media/admin.png" alt="admin">
                        </a>
                        {% endif %}
                        <div class="navbar-item has-dropdown is-hoverable">
                            <a class="navbar-link">
                                <img src="../media/profile-icon.png" alt="profile-icon">
                            </a>
                            <div class="navbar-dropdown is-right">
                                <a class="navbar-item" href="">
                                    see profile
                                </a>
                                <a class="navbar-item" href="">
                                    see orders
                                </a>
                                <a class="navbar-item" href="{% url 'account_logout' %}">
                                    log out
                                </a>
                                {% else %}
                                <a class="navbar-item" href="{% url 'account_login' %}">
                                    log in
                                </a>
                                <a class="navbar-item" href="{% url 'account_signup' %}">
                                    register
                                </a>
                                {% endif %}
                            </div>
                        </div>
                        <a class="navbar-item" href="">
                            <img src="../media/bag.png" alt="bag-icon">
                            <p>{% if grand_total %}
                                £{{ grand_total|floatformat:2 }}
                                {% else %}
                                £0.00
                                {% endif %}
                            </p>
                        </a>
                    </div>
                    <!-- end of hidden mobile  -->
                    <!-- navbar end hidden desktop  -->
                    <div class="navbar-end is-hidden-desktop">
                        <div class="column is-vcentered">
                            <div class="field has-addons search-form">
                                <div class="control" method="GET" action="">
                                    <input class="input" type="text" placeholder="Find a product" name="q">
                                </div>
                                <div class="control">
                                    <a class="button is-danger">
                                        <i class="fas fa-search"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                        <a class="navbar-item" href="#">
                            <img src="../media/blog.png" alt="blog" class="mobile-icon">
                            blog
                        </a>
                        {% if request.user.is_authenticated %}
                        {% if request.user.is_superuser %}
                        <a class="navbar-item" href="">
                            <img src="../media/admin.png" alt="admin" class="mobile-icon">
                            admin
                        </a>
                        {% endif %}
                        <div class="navbar-item has-dropdown is-hoverable">
                            <a class="navbar-link">
                                <img src="../media/profile-icon.png" alt="profile-icon" class="mobile-icon">
                                profile
                            </a>
                            <div class="navbar-dropdown">
                                <ul>
                                    <li>
                                        <a class="navbar-item" href="">
                                            see profile
                                        </a>
                                    </li>
                                    <li>
                                        <a class="navbar-item" href="">
                                            see orders
                                        </a>
                                    </li>
                                    <li>
                                        <a class="navbar-item" href="{% url 'account_logout' %}">
                                            log out
                                        </a>
                                    </li>
                                    {% else %}
                                    <li>
                                        <a class="navbar-item" href="{% url 'account_login' %}">
                                            log in
                                        </a>
                                    </li>
                                    <li>
                                        <a class="navbar-item" href="{% url 'account_signup' %}">
                                            register
                                        </a>
                                    </li>
                                    {% endif %}
                                </ul>

                            </div>
                        </div>
                        <a class="navbar-item" href="">
                            <img src="../media/bag.png" alt="bag-icon" class="mobile-icon">
                            {% if grand_total %}
                            £{{ grand_total|floatformat:2 }}
                            {% else %}
                            £0.00
                            {% endif %}

                        </a>
                    </div>
                    <!-- end of hidden on desktop  -->
                </div>
            </nav>
        </div>


        {% if messages %}
        <div class="message-container">
            {% for message in messages %}
            {% with message.level as level %}
            {% if level == 40 %}
            {% include 'includes/toasts/toast_error.html' %}
            {% elif level == 30 %}
            {% include 'includes/toasts/toast_warning.html' %}
            {% elif level == 25 %}
            {% include 'includes/toasts/toast_success.html' %}
            {% else %}
            {% include 'includes/toasts/toast_info.html' %}
            {% endif %}
            {% endwith %}
            {% endfor %}
        </div>
        {% endif %}

        {% block page_header %}
        {% endblock %}

        {% block content %}


        {% endblock %}
        <!-- Hero footer: will stick at the bottom -->
        <div class="hero-foot">
            <nav class="tabs">
                <div class="container">
                    <div class="columns">
                        <ul class="column is-justify-content-flex-start is-flex-direction-column">
                            <li><a>Overview</a></li>
                            <li><a>T&Cs</a></li>
                            <li><a>Privacy Policy</a></li>
                            <li><a>FAQs</a></li>
                        </ul>
                        <ul class="column is-justify-content-flex-end is-flex-direction-column">
                            <li><a>Facebook</a></li>
                            <li><a>Instagram</a></li>
                            <li><a>GitHub</a></li>
                            <li><a>Pinterest</a></li>
                        </ul>
                    </div>
                </div>
            </nav>
        </div>
    </section>

    {% block postloadjs %}
    <script>
        // $('.toast').toast('show');

        // code from Bulma GitHub to fix the navbar menu always open on mobile 
        // https://github.com/jgthms/bulma/issues/2361
        document.addEventListener("DOMContentLoaded", () => {
            const hamburgerButton = document.querySelector(".navbar-burger");
            const navMenu = document.querySelector(".navbar-menu");

            hamburgerButton.addEventListener("click", () => {
                hamburgerButton.classList.toggle("is-active");
                navMenu.classList.toggle("is-active");
            });

            const allDropdowns = document.querySelectorAll(
                ".navbar-item.has-dropdown"
            );

            allDropdowns.forEach((dropdown) => {
                dropdown.addEventListener("click", () => {
                    const elem = dropdown.querySelector(".navbar-dropdown");
                    elem.classList.toggle("is-active");
                });
            });
        });
    </script>
    {% endblock %}

</body>

</html>